<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="icon" type="image/png" sizes="32x32" href="assets/images/favicon-32x32.png">
        <link rel="stylesheet" href="dessertButtonSelectedComponent.css">
        <link rel="stylesheet" href="dessertButtonComponent.css">
        <title>kephalosk | Product List With Chart</title>
        <style>
            @font-face {
                font-family: 'Red Hat Text';
                src: url('assets/fonts/RedHatText-VariableFont_wght.ttf') format('truetype');
                font-weight: 400 700;
                font-style: normal;
            }

            @font-face {
                font-family: 'Red Hat Text';
                src: url('assets/fonts/RedHatText-Italic-VariableFont_wght.ttf') format('truetype');
                font-weight: 400 700;
                font-style: italic;
            }

            .attribution {
                font-size: 11px;
                text-align: center;
            }

            .attribution a {
                color: hsl(228, 45%, 44%);
            }

            .cartBox {
                background-color: hsl(0, 0%, 100%);
                border-radius: 10px;
                padding: 24px;
                width: 384px;
            }

            .cartBoxHeadline{
                color: hsl(14, 86%, 42%);
                display: block;
                font-size: 24px;
                font-weight: bold;
                margin-bottom: 24px;
                margin-top: 4px;
            }

            .cartBoxEmpty {
                align-items: center;
                display: flex;
                flex-direction: column;
            }

            .cartBoxEmpty p {
                color: hsl(12, 20%, 44%);
                font-size: 13px;
                font-weight: 600;
            }

            .cartBoxEmptyImage {
                margin-top: 40px;
                width: 122px;
            }

            .category {
                color: hsl(12, 20%, 44%);
                display: block;
                font-size: 14px;
                margin-top: 40px;
            }

            .dessertButton img {
                margin-right: 8px;
            }

            .dessertContent {
                position: relative;
            }

            .desserts {
                display: grid;
                grid-template-rows: auto 1fr;
            }

            .dessertsGrid {
                display: grid;
                grid-template-rows: 1fr 1fr 1fr;
            }

            .dessertsGridItem {
                display: flex;
                flex-direction: column;
                max-width: 250px;
                padding: 12px;
            }

            .dessertsGridRow {
                display: grid;
                grid-template-columns: auto auto auto;
                height: 100%;
                max-width: 822px;
            }

            .dessertsGridRow img{
                border-radius: 10px;
                max-width: 250px;
            }

            .hidden {
                display: none;
            }

            .priceBox {
                color: hsl(14, 86%, 42%);
                font-weight: bold;
            }

            * {
                box-sizing: border-box;
            }

            body {
                align-items: center;
                background-color: hsl(20, 50%, 98%);
                display: flex;
                flex-direction: column;
                font-family: 'Red Hat Text', sans-serif;
                justify-content: center;
                padding: 90px 100px 0 100px;
            }

            h1 {
                color: hsl(14, 65%, 9%);
                font-size: 40px;
                letter-spacing: 1px;
                margin-top: 0;
            }

            h2 {
                color: hsl(12, 20%, 44%);
                font-size: 15px;
                margin: 5px 0;
            }

            main {
                display: grid;
                grid-template-columns: auto auto;
                width: 100%;
            }

            .colors {
                color: hsl(14, 86%, 42%);
                color: hsl(159, 69%, 38%);
                color: hsl(20, 50%, 98%);
                color: hsl(13, 31%, 94%);
                color: hsl(14, 25%, 72%);
                color: hsl(7, 20%, 60%);
                color: hsl(12, 20%, 44%);
                color: hsl(14, 65%, 9%);
            }

            .cartBoxSelectedButton {
                background-color: hsl(14, 86%, 42%);
                border: 0;
                border-radius: 50px;
                color: hsl(0, 0%, 100%);
                cursor: pointer;
                font-weight: 600;
                margin-top: 24px;
                padding: 12px;
                width: 100%;
            }

            .cartBoxSelectedButton:hover {
                background-color: hsl(14, 86%, 30%);
            }

            .cartBoxSelectedHint {
                background-color: hsl(20, 50%, 98%);
                border-radius: 8px;
                color: hsl(12, 20%, 44%);
                display: flex;
                justify-content: center;
                margin-top: 24px;
                padding: 12px;
            }

            .cartBoxSelectedHint img {
                margin-right: 8px;
            }

            .cartBoxSelectedHint label {
                font-size: 14px;
                margin-right: 8px;
            }

            .cartBoxSelectedHint span {
                font-weight: 600;
            }

            .cartBoxSelectedListItem {
                align-items: center;
                display: flex;
            }

            .cartBoxSelectedListItemContent {
                display: flex;
                flex-direction: column;
            }

            .cartBoxSelectedListItemContent {
                flex-grow: 1;
            }

            .cartBoxSelectedListItemContentName {
                color: hsl(14, 65%, 9%);
                font-size: 14px;
                font-weight: 600;
            }

            .cartBoxSelectedListItemContentQuantity {
                color: hsl(12, 20%, 44%);
                font-size: 14px;
                margin-top: 5px;
            }

            .cartBoxSelectedListItemContentQuantityAmount {
                color: hsl(14, 86%, 42%);
                font-weight: 500;
                margin-right: 12px;
            }

            .cartBoxSelectedListItemContentQuantitySum {
                font-weight: 600;
                margin-left: 8px;
            }

            .cartBoxSelectedListItemRemove {
                border: 1px solid hsl(12, 20%, 44%);
                border-radius: 50px;
                color: hsl(12, 20%, 44%);
                cursor: pointer;
                padding: 0 6px;
            }

            .cartBoxSelectedListItemRemove:hover {
                border: 1px solid hsl(14, 65%, 9%);
                color: hsl(14, 65%, 9%);
            }

            .cartBoxSelectedTotal {
                align-items: center;
                color: hsl(14, 65%, 9%);
                display: flex;
                margin-top: 24px;
            }

            .cartBoxSelectedTotalName {
                flex-grow: 1;
                font-size: 14px;
            }

            .cartBoxSelectedTotalPrice {
                font-size: 18px;
                font-weight: 800;
            }

            hr {
                background-color: hsl(13, 31%, 94%);
                border: 0;
                height: 1px;
                margin: 14px 0;
            }
        </style>
        <script>
            document.addEventListener('DOMContentLoaded', async () => {
                await loadComponents();
                addDessertButtonEventListener();
            });

            function addDessertButtonEventListener() {
                const dessertButtons = document.querySelectorAll('.dessertButtonComponent');
                dessertButtons.forEach(button => {
                    const parentElement = button.parentElement;
                    const dessertButton = button.firstElementChild;
                    const dessertButtonSelected = parentElement.querySelector('.dessertButtonSelectedComponent');

                    button.addEventListener('click', addItem);
                    button.addEventListener('keydown', (event) => {
                        if (event.key === 'Enter' || event.key === ' '){
                            addItem.call(this);
                        }
                    });

                    function addItem() {
                        const buttonLabel = dessertButtonSelected.querySelector('.dessertButtonSelectedLabel');
                        buttonLabel.textContent = '1';
                        dessertButton.classList.add('hidden');
                        dessertButtonSelected.classList.remove('hidden');
                        updateCart(dessertButton, dessertButtonSelected);
                    }

                    addDessertButtonSelectedMinusEventListener(dessertButton, dessertButtonSelected);
                    addDessertButtonSelectedPlusEventListener(dessertButton, dessertButtonSelected);
                })
            }

            function addDessertButtonSelectedMinusEventListener(dessertButton, dessertButtonSelected) {
                const buttonMinus = dessertButtonSelected.querySelector('.dessertButtonSelectedIconMinus');

                buttonMinus.addEventListener('click', decrement);
                buttonMinus.addEventListener('keydown', (event) => {
                    if (event.key === 'Enter' || event.key === ' '){
                        decrement.call(this);
                    }
                });

                function decrement() {
                    const buttonLabel = dessertButtonSelected.querySelector('.dessertButtonSelectedLabel');
                    const labelValue = parseInt(buttonLabel.textContent, 10);

                    if (labelValue <= 1){
                        buttonLabel.textContent = '0';
                        dessertButton.classList.remove('hidden');
                        dessertButtonSelected.classList.add('hidden');
                    } else {
                        buttonLabel.textContent = labelValue - 1;
                    }
                    updateCart(dessertButton, dessertButtonSelected);
                }
            }

            function addDessertButtonSelectedPlusEventListener(dessertButton, dessertButtonSelected) {
                const buttonPlus = dessertButtonSelected.querySelector('.dessertButtonSelectedIconPlus');

                buttonPlus.addEventListener('click', increment);
                buttonPlus.addEventListener('keydown', (event) => {
                    if (event.key === 'Enter' || event.key === ' '){
                        increment.call(this);
                    }
                });

                function increment() {
                    const buttonLabel = dessertButtonSelected.querySelector('.dessertButtonSelectedLabel');
                    const currentValue = parseInt(buttonLabel.textContent, 10);

                    buttonLabel.textContent = currentValue + 1;
                    updateCart(dessertButton, dessertButtonSelected);
                }
            }

            function updateCart(dessertButton, dessertButtonSelected) {
                const newAmount = dessertButtonSelected.querySelector('.dessertButtonSelectedLabel').textContent;
                const dessertContent = dessertButtonSelected.parentElement;
                const name = dessertContent.querySelector('h2').textContent;
                let totalSum = 0;

                const cartBoxSelectedListItemContents = document.querySelectorAll('.cartBoxSelectedListItemContent');
                cartBoxSelectedListItemContents.forEach(item => {
                    const cartBoxSelectedListItemContentName = item.querySelector('.cartBoxSelectedListItemContentName');
                    if(cartBoxSelectedListItemContentName.textContent === name) {
                        const price = parseFloat(item.querySelector('.price').textContent);
                        const sum = newAmount * price;

                        item.querySelector('.cartBoxSelectedListItemContentQuantityAmount').textContent = newAmount + 'x';
                        item.querySelector('.cartBoxSelectedListItemContentQuantitySum').textContent = "$" + parseFloat(sum.toString()).toFixed(2).toString();

                        totalSum = totalSum + sum;

                        const listItem = item.parentElement;
                        const section = listItem.parentElement;
                        parseInt(newAmount) === 0 ? section.classList.add('hidden') : section.classList.remove('hidden');
                    } else {
                        const sumString = item.querySelector('.cartBoxSelectedListItemContentQuantitySum').textContent;
                        const sumFloat = parseFloat(sumString.replace('$',''));
                        totalSum = totalSum + sumFloat;
                    }
                });

                const cartBoxEmpty = document.querySelector('.cartBoxEmpty');
                const cartBoxSelected = document.querySelector('.cartBoxSelected');
                if (totalSum === 0){
                    cartBoxEmpty.classList.remove('hidden');
                    cartBoxSelected.classList.add('hidden');
                } else if (cartBoxSelected.classList.contains('hidden')) {
                    cartBoxEmpty.classList.add('hidden');
                    cartBoxSelected.classList.remove('hidden');
                }

                const cartBoxSelectedTotalPrice = document.querySelector('.cartBoxSelectedTotalPrice');
                cartBoxSelectedTotalPrice.textContent = '$' + parseFloat(totalSum).toFixed(2);
            }

            async function loadComponents() {
                await loadDessertButton();
                await loadDessertButtonSelected();
                await loadCartItems();
            }

            async function loadDessertButton() {
                await fetch('dessertButtonComponent.html?' + new Date().getTime())
                    .then(response => response.text())
                    .then(data => {
                        const dessertButtons = document.querySelectorAll('.dessertButtonComponent');
                        dessertButtons.forEach(button => {
                           button.innerHTML = data;
                        });
                    });
            }

            async function loadDessertButtonSelected() {
                await fetch('dessertButtonSelectedComponent.html?' + new Date().getTime())
                    .then(response => response.text())
                    .then(data => {
                        const dessertButtonsSelected = document.querySelectorAll('.dessertButtonSelectedComponent');
                        dessertButtonsSelected.forEach(button => {
                            button.innerHTML = data;
                            button.classList.add('hidden');
                        });
                    });
            }

            async function loadCartItems() {
                await fetch('cartBoxSelectedListItemComponent.html?' + new Date().getTime())
                    .then(response => response.text())
                    .then(data => {
                        const dessertsGridItems = document.querySelectorAll('.dessertsGridItem');
                        const cartBoxSelectedListItems = document.querySelector('.cartBoxSelectedListItems');
                        let listItemsHtml = '';
                        let totalSum = 0;

                        dessertsGridItems.forEach(item => {
                            const newItem = document.createRange().createContextualFragment(data);
                            const name = item.querySelector('h2').textContent;
                            const amount = parseInt(item.querySelector('.dessertButtonSelectedLabel').textContent,10);
                            const price = parseFloat(item.querySelector('.price').textContent);
                            const sum = amount * price;

                            newItem.querySelector('.cartBoxSelectedListItemContentName').textContent = name;
                            newItem.querySelector('.cartBoxSelectedListItemContentQuantityAmount').textContent = amount + 'x';
                            newItem.querySelector('.price').textContent = parseFloat(price.toString()).toFixed(2).toString();
                            newItem.querySelector('.cartBoxSelectedListItemContentQuantitySum').textContent = "$" + parseFloat(sum.toString()).toFixed(2).toString();

                            totalSum = totalSum + sum;
                            listItemsHtml = listItemsHtml + newItem.firstElementChild.outerHTML;

                            if(amount === 0){
                                newItem.querySelector('section').classList.add('hidden');
                            }
                        });
                        cartBoxSelectedListItems.innerHTML = listItemsHtml;

                        const cartBoxSelectedTotalPrice = document.querySelector('.cartBoxSelectedTotalPrice');
                        cartBoxSelectedTotalPrice.textContent = '$' + parseFloat(totalSum).toFixed(2);

                        const cartBoxEmpty = document.querySelector('.cartBoxEmpty')
                        const cartBoxSelected = document.querySelector('.cartBoxSelected');
                        if(totalSum === 0) {
                            cartBoxEmpty.classList.remove('hidden');
                            cartBoxSelected.classList.add('hidden');
                        } else {
                            cartBoxEmpty.classList.add('hidden');
                            cartBoxSelected.classList.remove('hidden');
                        }
                    });
            }
        </script>
    </head>
    <body>
        <main>
            <section class="desserts">
                <h1>Desserts</h1>
                <div class="dessertsGrid">
                    <div class="dessertsGridRow dessertsGridRow1">
                        <div class="dessertsGridRow1Left dessertsGridItem">
                            <img src="assets/images/image-waffle-desktop.jpg" alt="image of waffles">
                            <div class="dessertContent">
                                <div class="dessertButtonComponent"></div>
                                <div class="dessertButtonSelectedComponent"></div>
                                <label class="category">Waffle</label>
                                <h2>Waffle with Berries</h2>
                                <div class="priceBox">
                                    <label class="Currency">$</label>
                                    <label class="price">6.50</label>
                                </div>
                            </div>
                        </div>
                        <div class="dessertsGridRow1Middle dessertsGridItem">
                            <img src="assets/images/image-creme-brulee-desktop.jpg" alt="image of creme brulee">
                            <div class="dessertContent">
                                <div class="dessertButtonComponent"></div>
                                <div class="dessertButtonSelectedComponent"></div>
                                <label class="category">Crème Brûlée</label>
                                <h2>Vanilla Bean Crème Brûlée</h2>
                                <div class="priceBox">
                                    <label class="Currency">$</label>
                                    <label class="price">7.00</label>
                                </div>
                            </div>
                        </div>
                        <div class="dessertsGridRow1Right dessertsGridItem">
                            <img src="assets/images/image-macaron-desktop.jpg" alt="image of macaron">
                            <div class="dessertContent">
                                <div class="dessertButtonComponent"></div>
                                <div class="dessertButtonSelectedComponent"></div>
                                <label class="category">Macaron</label>
                                <h2>Macaron Mix of Five</h2>
                                <div class="priceBox">
                                    <label class="Currency">$</label>
                                    <label class="price">8.00</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="dessertsGridRow dessertsGridRow2">
                        <div class="dessertsGridRow2Left dessertsGridItem">
                            <img src="assets/images/image-tiramisu-desktop.jpg" alt="image of tiramisu">
                            <div class="dessertContent">
                                <div class="dessertButtonComponent"></div>
                                <div class="dessertButtonSelectedComponent"></div>
                                <label class="category">Tiramisu</label>
                                <h2>Classic Tiramisu</h2>
                                <div class="priceBox">
                                    <label class="Currency">$</label>
                                    <label class="price">5.50</label>
                                </div>
                            </div>
                        </div>
                        <div class="dessertsGridRow2Middle dessertsGridItem">
                            <img src="assets/images/image-baklava-desktop.jpg" alt="image of baklava">
                            <div class="dessertContent">
                                <div class="dessertButtonComponent"></div>
                                <div class="dessertButtonSelectedComponent"></div>
                                <label class="category">Baklava</label>
                                <h2>Pistachio Baklava</h2>
                                <div class="priceBox">
                                    <label class="Currency">$</label>
                                    <label class="price">4.00</label>
                                </div>
                            </div>
                        </div>
                        <div class="dessertsGridRow2Right dessertsGridItem">
                            <img src="assets/images/image-meringue-desktop.jpg" alt="image of waffles">
                            <div class="dessertContent">
                                <div class="dessertButtonComponent"></div>
                                <div class="dessertButtonSelectedComponent"></div>
                                <label class="category">Pie</label>
                                <h2>Lemon Meringue Pie</h2>
                                <div class="priceBox">
                                    <label class="Currency">$</label>
                                    <label class="price">5.00</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="dessertsGridRow dessertsGridRow3">
                        <div class="dessertsGridRow3Left dessertsGridItem">
                            <img src="assets/images/image-cake-desktop.jpg" alt="image of waffles">
                            <div class="dessertContent">
                                <div class="dessertButtonComponent"></div>
                                <div class="dessertButtonSelectedComponent"></div>
                                <label class="category">Cake</label>
                                <h2>Red Velvet Cake</h2>
                                <div class="priceBox">
                                    <label class="Currency">$</label>
                                    <label class="price">4.50</label>
                                </div>
                            </div>
                        </div>
                        <div class="dessertsGridRow3Middle dessertsGridItem">
                            <img src="assets/images/image-brownie-desktop.jpg" alt="image of waffles">
                            <div class="dessertContent">
                                <div class="dessertButtonComponent"></div>
                                <div class="dessertButtonSelectedComponent"></div>
                                <label class="category">Brownie</label>
                                <h2>Salted Caramel Brownie</h2>
                                <div class="priceBox">
                                    <label class="Currency">$</label>
                                    <label class="price">4.50</label>
                                </div>
                            </div>
                        </div>
                        <div class="dessertsGridRow3Right dessertsGridItem">
                            <img src="assets/images/image-panna-cotta-desktop.jpg" alt="image of waffles">
                            <div class="dessertContent">
                                <div class="dessertButtonComponent"></div>
                                <div class="dessertButtonSelectedComponent"></div>
                                <label class="category">Panna Cotta</label>
                                <h2>Vanilla Panna Cotta</h2>
                                <div class="priceBox">
                                    <label class="Currency">$</label>
                                    <label class="price">6.50</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <section class="cart">
                <div class="cartBox">
                    <label class="cartBoxHeadline">Your Cart (<span class="itemsAmountTotal">0</span>)</label>
                    <div class="cartBoxEmpty">
                        <img class="cartBoxEmptyImage" src="assets/images/illustration-empty-cart.svg" alt="image of cake">
                        <p>Your added items will appear here</p>
                    </div>
                    <div class="cartBoxSelected hidden">
                        <div class="cartBoxSelectedList">
                            <div class="cartBoxSelectedListItems"></div>
                        </div>
                        <div class="cartBoxSelectedTotal">
                            <label class="cartBoxSelectedTotalName">Order Total</label>
                            <label class="cartBoxSelectedTotalPrice">$46.50</label>
                        </div>
                        <div class="cartBoxSelectedHint">
                            <img src="assets/images/icon-carbon-neutral.svg" alt="carbon neutral icon">
                            <label>This is a <span>carbon-neutral</span> delivery</label>
                        </div>
                        <button class="cartBoxSelectedButton">Confirm Order</button>
                    </div>
                </div>
            </section>
        </main>
        <footer class="attribution">
            Challenge by <a href="https://www.frontendmentor.io&ref/challenge">Frontend Mentor</a>.
            Coded by <a href="#">kephalosk</a>.
        </footer>
    </body>
</html>